<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Python中使用lxml分析HTML</title>
      <link href="//article/4e2af80c611a/"/>
      <url>//article/4e2af80c611a/</url>
      
        <content type="html"><![CDATA[<h1>Python中使用lxml分析HTML</h1><p>使用<code>lxml.html</code>库中的<code>fromstring</code>模块分析html</p><span id="more"></span><h2 id="xpath表达式">xpath表达式</h2><p>绝对路径 如 <code>page.xpath(&quot;/html/body/p&quot;)</code> ，它会找到body这个节点下所有的p标签 <br>相对路径 <code>page.xpath(&quot;//p&quot;)</code> ,它会找到整个html代码里的所有p标签。</p><table><thead><tr><th>表达式</th><th>描述</th></tr></thead><tbody><tr><td>nodename</td><td>选取此节点的所有子节点</td></tr><tr><td>/</td><td>从根节点选取</td></tr><tr><td>//</td><td>从匹配选择的当前节点选择文档中的节点，而不考虑它们的位置</td></tr><tr><td>.</td><td>选取当前节点</td></tr><tr><td>…</td><td>选取当前节点的父节点</td></tr><tr><td>@</td><td>选取属性</td></tr></tbody></table><table><thead><tr><th>表达式</th><th>结果</th></tr></thead><tbody><tr><td>/div/book[1]</td><td>div子元素的第一个book元素</td></tr><tr><td>/div/book[last()]</td><td>div子元素的最后一个book元素</td></tr><tr><td>/div/book[last()-1]</td><td>div子元素的倒数第二个book元素</td></tr><tr><td>/div/book[position()&lt;3]</td><td>最前面的两个div元素的子元素的book元素</td></tr><tr><td>//title[@lang]</td><td>所有拥有名为lang的属性的title元素</td></tr><tr><td>/html/body/a[text()=“Python”]</td><td>按照文本内容索引</td></tr><tr><td>/html/body/a[position()=2]]</td><td>按照文本内容索引</td></tr><tr><td>//title[@lang=’ eng’]</td><td>所有title元素，且这些元素拥有值为eng 的lang属性</td></tr><tr><td>/div/book[price&gt;35.00]</td><td>div元素所有book元素，且其中price元素值大于35.00</td></tr><tr><td>/div/book[price&gt;35.00]/title</td><td>div元素中book元素的所有title元素，且其中的price元素的值须大于35.00</td></tr></tbody></table><table><thead><tr><th>表达式</th><th>结果</th></tr></thead><tbody><tr><td>/bookstore/*</td><td>选取 bookstore 元素的所有子元素</td></tr><tr><td>//*</td><td>选取文档中的所有元素</td></tr><tr><td>//title[@*]</td><td>选取所有带有属性的 title 元素</td></tr><tr><td>//book/title | //book/price</td><td>选取 book 元素的所有 title 和 price 元素</td></tr></tbody></table><h2 id="常规引用">常规引用</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> lxml.html <span class="keyword">import</span> fromstring</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parser_html</span>(<span class="params">html: <span class="built_in">str</span></span>):</span><br><span class="line">    selector = fromstring(html)</span><br><span class="line">    name = selector.xpath(<span class="string">&#x27;.//form/div/div/text()&#x27;</span>)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> HTML </tag>
            
            <tag> 编程 </tag>
            
            <tag> 爬虫 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在网页上加入live2d</title>
      <link href="//article/ceb8d296d4c1/"/>
      <url>//article/ceb8d296d4c1/</url>
      
        <content type="html"><![CDATA[<h1>Live2D Widget</h1><p><img src="https://forthebadge.com/images/badges/built-with-love.svg" alt=""><img src="https://forthebadge.com/images/badges/uses-html.svg" alt=""><img src="https://forthebadge.com/images/badges/made-with-javascript.svg" alt=""><img src="https://forthebadge.com/images/badges/contains-cat-gifs.svg" alt=""><img src="https://forthebadge.com/images/badges/powered-by-electricity.svg" alt=""><img src="https://forthebadge.com/images/badges/makes-people-smile.svg" alt=""></p><h2 id="项目地址">项目地址</h2><p>我的Fork: <a href="https://github.com/RandomEnch/live2d-widget">https://github.com/RandomEnch/live2d-widget</a> <br>原地址: <a href="https://github.com/stevenjoezhang/live2d-widget">https://github.com/stevenjoezhang/live2d-widget</a> <br>修改于: <a href="https://github.com/fghrsh/live2d_demo">https://github.com/fghrsh/live2d_demo</a> <br>API: <a href="https://github.com/fghrsh/live2d_api">https://github.com/fghrsh/live2d_api</a></p><h2 id="特点">特点</h2><p>在网页中添加 Live2D 看板娘。兼容 PJAX，支持无刷新加载。<br>警告：本项目使用了大量 ES6 语法，不支持 IE 11 等老旧浏览器。</p><h2 id="示例">示例</h2><p>在PC端博客的右下角可查看效果。<br><img src="/img/live2d/live2d_demo.png" width="280" /></p><h2 id="依赖">依赖</h2><p>插件需要 Font Awesome 图标支持，请确保相关样式表已在页面中加载。以 Font Awesome v6 为例，请在 <code>&lt;head&gt;</code> 中导入 <code>all.min.css</code> 。<br>建议保存到本地后导入</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://blog.randomench.top/live2d-widget/all.min.css&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="使用">使用</h2><p>将这一行代码加入<code>&lt;head&gt;</code>或<code>&lt;body&gt;</code>，即可展现出效果：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://blog.randomench.top/live2d-widget/autoload.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>如果网站启用了 PJAX，由于看板娘不必每页刷新，因此要注意将相关脚本放到 PJAX 刷新区域之外。</p><p>换句话说，如果你是小白，或者只需要最基础的功能，就只用把这一行代码，连同前面加载 Font Awesome 的一行代码，一起放到 html 的 <code>&lt;head&gt;</code> 中即可。<br>对于用各种模版引擎（例如 Nunjucks，Jinja 或者 PHP）生成的页面，也要自行修改，方法类似，只是可能略为麻烦。</p><p>但是！我们强烈推荐自己进行配置，否则很多功能是不完整的，并且可能产生问题！<br>如果你有兴趣自己折腾的话，请看下面的详细说明。</p><h2 id="自定义配置">自定义配置</h2><p>因为原来的项目使用了jsdeliver，现在jsdeliver在大陆不可用，因此原项目无法正常使用，此处使用的是我自己构建的版本。<br>如果想自己修改使用，请自行clone原项目仓库。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/stevenjoezhang/live2d-widget.git</span><br></pre></td></tr></table></figure><p>原项目部分内容已失效，如不想更改，可clone我的fork仓库。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/RandomEnch/live2d-widget.git</span><br></pre></td></tr></table></figure><h3 id="修改">修改</h3><p>修改<code>autoload.js</code>第34行后部分为：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">initWidget</span>(&#123;</span><br><span class="line"><span class="attr">waifuPath</span>: live2d_path + <span class="string">&quot;waifu-tips.json&quot;</span>,</span><br><span class="line"><span class="attr">apiPath</span>: <span class="string">&quot;你的自建api地址(可本地，可链接)&quot;</span>,</span><br><span class="line"><span class="comment">//cdnPath: &quot;https://cdn.jsdelivr.net/gh/fghrsh/live2d_api/&quot;</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="API">API</h3><p><code>initWidget</code> 方法接受名为 <code>apiPath</code> 和 <code>cdnPath</code> 的参数，两者设置其中一项即可。其中 <code>apiPath</code> 为后端 API 的 URL，可以自行搭建，并增加模型。<br>由于请求的 <code>cdnPath</code> 也使用了jsdeliver，请自建 <code>apiPath</code> 后端api。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/fghrsh/live2d_demo.git</span><br></pre></td></tr></table></figure><p>将api放在网站目录中即可本地引用api，<code>autoload.js</code>格式为：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">initWidget</span>(&#123;</span><br><span class="line"><span class="attr">waifuPath</span>: live2d_path + <span class="string">&quot;waifu-tips.json&quot;</span>,</span><br><span class="line"><span class="attr">apiPath</span>: <span class="string">&quot;/live2d_demo/&quot;</span>,</span><br><span class="line"><span class="comment">//cdnPath: &quot;https://cdn.jsdelivr.net/gh/fghrsh/live2d_api/&quot;</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="目录结构-Files">目录结构 Files</h2><ul><li><code>waifu-tips.js</code> 包含了按钮和对话框的逻辑；</li><li><code>waifu-tips.json</code> 中定义了触发条件（<code>selector</code>，CSS 选择器）和触发时显示的文字（<code>text</code>）；</li><li><code>waifu.css</code> 是看板娘的样式表。</li></ul><p class="div-border left red">警告：作者不对包括但不限于 waifu-tips.js 和 waifu-tips.json 文件中的内容负责，请自行确保它们是合适的。</p>]]></content>
      
      
      <categories>
          
          <category> 编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 编程 </tag>
            
            <tag> 实用 </tag>
            
            <tag> 前端 </tag>
            
            <tag> live2d </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python的网络请求</title>
      <link href="//article/083021be7f36/"/>
      <url>//article/083021be7f36/</url>
      
        <content type="html"><![CDATA[<h1>序</h1><p>记Python学习过程中遇到的问题及技巧总结</p><span id="more"></span><h1>pip的换源</h1><p>pip安装一些库的时候时常卡住，此时可以使用换源来解决。</p><div class="tabs" id="pip"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#pip-1">临时</button></li><li class="tab"><button type="button" data-href="#pip-2">永久</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="pip-1"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install xxx -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="pip-2"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip config <span class="built_in">set</span> <span class="keyword">global</span>.index-url https://pypi.tuna.tsinghua.edu.cn/simple</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="国内常用镜像源：">国内常用镜像源：</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">阿里云 http://mirrors.aliyun.com/pypi/simple/</span><br><span class="line">豆瓣http://pypi.douban.com/simple/</span><br><span class="line">清华大学 https://pypi.tuna.tsinghua.edu.cn/simple/</span><br><span class="line">中国科学技术大学 http://pypi.mirrors.ustc.edu.cn/simple/</span><br><span class="line">华中科技大学http://pypi.hustunique.com/</span><br></pre></td></tr></table></figure><h1>网页请求</h1><p>request，aiohttp，httpx的简单使用</p><h2 id="代理">代理</h2><div class="tabs" id="proxy"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#proxy-1">httpx</button></li><li class="tab"><button type="button" data-href="#proxy-2">requests</button></li><li class="tab"><button type="button" data-href="#proxy-3">aiohttp异步请求</button></li><li class="tab"><button type="button" data-href="#proxy-4">httpx异步请求</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="proxy-1"><p>httpx拥有全局的默认超时时间，没有特殊需要的话不需要设置</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> httpx</span><br><span class="line"></span><br><span class="line">proxies = &#123;</span><br><span class="line">    <span class="string">&quot;http://&quot;</span>: <span class="string">&quot;http://localhost:1080&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://&quot;</span>: <span class="string">&quot;http://localhost:8031&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">r = httpx.get(<span class="string">&#x27;https://www.example.org/&#x27;</span>, proxies=proxies)</span><br><span class="line">text = r.text</span><br><span class="line">content = r.content</span><br><span class="line">data = r.json()</span><br><span class="line">status_code = r.status_code</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="proxy-2"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">proxies = &#123;</span><br><span class="line">    <span class="string">&quot;http&quot;</span>: <span class="string">&quot;http://localhost:1080&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https&quot;</span>: <span class="string">&quot;http://localhost:8030&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">r = requests.get(<span class="string">&#x27;https://www.example.org/&#x27;</span>, proxies=proxies, timeout=<span class="number">10</span>)</span><br><span class="line">text = r.text</span><br><span class="line">content = r.content</span><br><span class="line">data = r.json()</span><br><span class="line">status_code = r.status_code</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="proxy-3"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> aiohttp</span><br><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"> </span><br><span class="line">proxy = <span class="string">&quot;http://localhost:1080&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">with</span> aiohttp.ClientSession() <span class="keyword">as</span> session:</span><br><span class="line">        <span class="keyword">async</span> <span class="keyword">with</span> session.get(<span class="string">&#x27;https://www.example.org/&#x27;</span>, proxy=proxy) <span class="keyword">as</span> resp:</span><br><span class="line">            <span class="keyword">if</span> resp.status == <span class="number">200</span>:</span><br><span class="line">                data= <span class="keyword">await</span> resp.text()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    loop = asyncio.get_event_loop()</span><br><span class="line">    loop.run_until_complete(main())</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="proxy-4"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">with</span> httpx.AsyncClient() <span class="keyword">as</span> client:</span><br><span class="line">    resp = <span class="keyword">await</span> client.get(<span class="string">&#x27;https://www.example.org/&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> resp.status_code == <span class="number">200</span>:</span><br><span class="line">        html = resp.text</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="SSL证书错误">SSL证书错误</h2><div class="tabs" id="ssl"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#ssl-1">httpx</button></li><li class="tab"><button type="button" data-href="#ssl-2">requests</button></li><li class="tab"><button type="button" data-href="#ssl-3">aiohttp</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="ssl-1"><p>在<code>AsyncClient</code>中加入<code>verify=False</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">with</span> httpx.AsyncClient(verify=<span class="literal">False</span>) <span class="keyword">as</span> client:</span><br><span class="line">    resp = <span class="keyword">await</span> client.get(<span class="string">&#x27;https://www.example.org/&#x27;</span>)</span><br><span class="line">    <span class="keyword">assert</span> resp.status_code == <span class="number">200</span></span><br><span class="line">    html = resp.text</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="ssl-2"><p>加入<code>verify=False</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">r = requests.get(<span class="string">&#x27;https://www.example.org/&#x27;</span>, timeout=<span class="number">10</span>, verify=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="ssl-3"><p>在<code>ClientSession</code>中加入<code>aiohttp.TCPConnector(verify_ssl=False)</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">con = aiohttp.TCPConnector(verify_ssl=<span class="literal">False</span>)</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">with</span> aiohttp.ClientSession(connector=con) <span class="keyword">as</span> session:</span><br><span class="line">        <span class="keyword">async</span> <span class="keyword">with</span> session.get(<span class="string">&#x27;https://www.example.org/&#x27;</span>, proxy=proxy, timeout=<span class="number">10</span>) <span class="keyword">as</span> resp:</span><br><span class="line">            <span class="keyword">if</span> resp.status == <span class="number">200</span>:</span><br><span class="line">                data= <span class="keyword">await</span> resp.text()</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="带cookie的请求">带cookie的请求</h2><p>先post请求login网址获取cookies，然后在headers和请求中加入cookies访问需要cookies的地址即可。</p><div class="tabs" id="cookie"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#cookie-1">requests</button></li><li class="tab"><button type="button" data-href="#cookie-2">httpx</button></li><li class="tab"><button type="button" data-href="#cookie-3">aiohttp</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="cookie-1"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">login_data = &#123;</span><br><span class="line">    <span class="string">&quot;username&quot;</span>: <span class="string">&quot;admin&quot;</span>,</span><br><span class="line">    <span class="string">&quot;password&quot;</span>: <span class="string">&quot;admin&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_cookie</span>():</span><br><span class="line">    session = requests.Session()</span><br><span class="line">    <span class="comment"># 部分网站login请求也需要加headers</span></span><br><span class="line">    session.post(login_url, data=login_data)</span><br><span class="line">    request_cookies = session.cookies.get_dict()</span><br><span class="line">    header = &#123;</span><br><span class="line">        <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">        <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:90.0) Gecko/20100101 Firefox/90.0&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Connection&quot;</span>: <span class="string">&quot;keep-alive&quot;</span>,</span><br><span class="line">        <span class="string">&quot;cookie&quot;</span>: <span class="string">f&quot;<span class="subst">&#123;cookie&#125;</span>&quot;</span> <span class="comment"># 不同网页的cookie格式不同，请适当更改</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> request_cookies, header</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">request</span>(<span class="params">*args</span>):</span><br><span class="line">    post_data = &#123;</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: <span class="string">&quot;xxx&quot;</span>,</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">    cookie, headers = get_cookie()</span><br><span class="line">    res = requests.post(url, headers=headers, cookies=cookie, data=post_data, allow_redirects=<span class="literal">False</span>)</span><br><span class="line">    <span class="keyword">return</span> res.text</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="cookie-2"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> http.cookies</span><br><span class="line"><span class="keyword">import</span> httpx</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">get_cookies</span>():</span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">with</span> httpx.AsyncClient() <span class="keyword">as</span> client:</span><br><span class="line">        resp = <span class="keyword">await</span> client.post(login_url, data=data)</span><br><span class="line">        <span class="keyword">if</span> resp.status_code == <span class="number">200</span>:</span><br><span class="line">            cookies = client.cookies</span><br><span class="line">            cookies = http.cookies.SimpleCookie(cookies)</span><br><span class="line">            cookies = &#123;i.key: i.value <span class="keyword">for</span> i <span class="keyword">in</span> cookies.values()&#125;</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            cookies = <span class="literal">None</span></span><br><span class="line">        headers = &#123;</span><br><span class="line">            <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&quot;</span>,</span><br><span class="line">            <span class="string">&quot;Accept-Encoding&quot;</span>: <span class="string">&quot;gzip, deflate, br&quot;</span>,</span><br><span class="line">            <span class="string">&quot;Accept-Language&quot;</span>: <span class="string">&quot;zh-CN,zh;q=0.9&quot;</span>,</span><br><span class="line">            <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">            <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:90.0) Gecko/20100101 Firefox/90.0&quot;</span>,</span><br><span class="line">            <span class="string">&quot;Connection&quot;</span>: <span class="string">&quot;keep-alive&quot;</span>,</span><br><span class="line">            <span class="string">&quot;cookie&quot;</span>: <span class="string">f&quot;session=<span class="subst">&#123;cookies[<span class="string">&#x27;session&#x27;</span>]&#125;</span>&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> cookies, headers</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="cookie-3"><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">get_cookies</span>():</span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">with</span> aiohttp.ClientSession() <span class="keyword">as</span> session:</span><br><span class="line">        <span class="keyword">async</span> <span class="keyword">with</span> session.post(login_url, data=data) <span class="keyword">as</span> resp:</span><br><span class="line">            <span class="keyword">if</span> resp.status == <span class="number">200</span>:</span><br><span class="line">                text = session.cookie_jar.filter_cookies(login_url)</span><br><span class="line">                cookie = &#123;i: text[i].value <span class="keyword">for</span> i <span class="keyword">in</span> text&#125;</span><br><span class="line">                <span class="keyword">return</span> cookie</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">None</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
      
      
      <categories>
          
          <category> 编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> 编程 </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> 实用 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>刷课插件分享</title>
      <link href="//article/7516a90986ca/"/>
      <url>//article/7516a90986ca/</url>
      
        <content type="html"><![CDATA[<h1>序</h1><p>想必大家都在为烦闷无聊的网课而烦恼，不刷又拿不到学分，在此推荐一些好用的刷网课插件。</p><span id="more"></span><h1>安装插件</h1><div class="tabs" id="plugin"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#plugin-1">油猴</button></li><li class="tab"><button type="button" data-href="#plugin-2">脚本猫</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="plugin-1"><p>使用Chrome或者Firefox浏览器，安装 <a href="https://chrome.google.com/webstore/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo">Tampermonkey</a> (油猴) 插件(需要翻墙)<br>没有梯子在 <a href="https://www.randomench.top/documents/Tampermonkey.zip">此处</a> 下载手动安装的文件</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="plugin-2"><p>使用Chrome或者Firefox浏览器，安装 <a href="https://chrome.google.com/webstore/detail/scriptcat/ndcooeababalnlpkfedmmbbbgkljhpjf">Script Cat</a> (脚本猫) 插件(需要翻墙)<br>或者在 <a href="https://github.com/scriptscat/scriptcat/releases/download/v0.9.1/scriptcat.zip">Github</a> 下载<br>没有梯子在 <a href="https://www.randomench.top/documents/scriptcat.zip">此处</a> 下载手动安装的文件</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h1>插件地址</h1><h2 id="多功能-支持超星和智慧树">多功能  (支持超星和智慧树)</h2><blockquote><p><a href="https://scriptcat.org/script-show-page/367">OCS 网课助手</a><br><a href="https://bbs.tampermonkey.net.cn/thread-61-1-1.html">网课小工具</a></p></blockquote><h2 id="刷课">刷课</h2><blockquote><p><a href="https://scriptcat.org/script-show-page/21">中国大学mooc</a><br><a href="https://scriptcat.org/script-show-page/10">超星学习通</a><br><a href="https://bbs.tampermonkey.net.cn/thread-16-1-1.html">超星学习通考试用</a><br><a href="https://scriptcat.org/script-show-page/12">智慧树知到</a></p></blockquote><h1>使用方法</h1><p>此处以chrome浏览器为例</p><h2 id="安装">安装</h2><p>如果插件从浏览器安装可跳过这一步<br>解压文件后得到crx文件<br>按下图步骤操作，选择crx文件安装，安装完毕<br><img src="/img/plugin/1.png" alt="1"><br><img src="/img/plugin/2.png" alt="2"><br><img src="/img/plugin/3.png" alt="3"></p><h2 id="脚本">脚本</h2><p>从上文中所给的链接中安装，全部安装完毕后重启浏览器即可使用。<br>相关网页中也可管理插件列表，具体方法不做说明。<br><img src="/img/plugin/4.png" alt="4"></p>]]></content>
      
      
      <categories>
          
          <category> 实用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 工具 </tag>
            
            <tag> 网课 </tag>
            
            <tag> 油猴 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>记实用网站</title>
      <link href="//article/923a8ce17df1/"/>
      <url>//article/923a8ce17df1/</url>
      
        <content type="html"><![CDATA[<h3 id="序">序</h3><p>在此记录一些实用的网址，有意者可评论追加。</p> <span id="more"></span><h3 id="工具">工具</h3><p><a href="https://music.liuzhijin.cn/">音乐直链搜索</a><br><a href="https://www.wenshushu.cn/">文件传输</a><br><a href="https://www.keyfc.net/bbs/tools/tudoucode.aspx">与佛论禅</a><br><a href="https://bigjpg.com/">图片分辨率提高</a><br><a href="https://msdn.itellyou.cn/">MSDN下载站</a><br><a href="https://saucenao.com/">SauceNAO</a><br><a href="https://ascii2d.net/">ascii2d</a><br><a href="https://minecraft.fandom.com/zh/wiki/Minecraft_Wiki">Minecraft_Wiki</a><br><a href="https://www.desmos.com/?lang=zh-CN">desmos</a><br><a href="https://ncm.worthsee.com/">NCM转MP3</a></p><h3 id="音游">音游</h3><p><a href="http://osugame.online/">Osu!网页版</a><br><a href="https://taiko.bui.pm/">太鼓达人网页版</a><br><a href="https://bangplayer.live/">Bang!Dream网页版</a><br><a href="https://www.thac.cc/kano/x/index.php/">4K练习</a><br><a href="https://lowi.ro/">LowLight下载站</a><br><a href="https://www.schwarzer.wang/">Schwarzer下载站</a><br><a href="https://map.bemanicn.com/">全国音游地图</a><br><a href="http://www.komani.moe/">Konami工具箱</a></p><h3 id="Galgame">Galgame</h3><p><a href="https://vndb.org/">VNDB</a><br><a href="https://bbs.zdfx.net/">终点论坛</a><br><a href="https://www.galcg.com/">Gal领域</a><br><a href="https://blog.reimu.net/">灵梦御所</a><br><a href="https://hacg.me/">琉璃神社</a><br><a href="https://ww1.galacg.me/">绅士仓库</a></p>]]></content>
      
      
      <categories>
          
          <category> 实用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 工具 </tag>
            
            <tag> Galgame </tag>
            
            <tag> 游戏 </tag>
            
            <tag> 网页 </tag>
            
            <tag> 音游 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>如何寻找Gal</title>
      <link href="//article/bda44aa762dd/"/>
      <url>//article/bda44aa762dd/</url>
      
        <content type="html"><![CDATA[<h3 id="准备">准备</h3><p>首先你需要知道你需要的Gal的名称，最好知道日文和英文，搜索时会用到，接着就可以去资源网查找了。</p><h3 id="不知道玩什么Gal">不知道玩什么Gal</h3><p><a href="https://vndb.org/">VNDB</a> 可以自选tag筛选Gal的网站，根据你想玩的类型选择tag查找吧~ <br>注：网页为英文<br><img src="/img/gal/vndb.png" alt="vndb"></p><h3 id="如何查找">如何查找</h3><blockquote><p><a href="https://www.galcg.com/">Gal领域</a> （不需要魔法，需要付费） <br><a href="https://blog.reimu.net/">灵梦御所</a> （需要魔法，可以通过改hosts文件直接访问） <br><a href="https://www.acg.gy/">琉璃神社</a> （需要魔法，此为域名发布页） <br><a href="https://bbs.zdfx.net/">终点论坛</a> （不需要魔法） <br><a href="https://myacg.xyz/">Myacg</a> （资源发布页）</p></blockquote><h3 id="如何使用琉璃神社">如何使用琉璃神社</h3><p>翻到页面最下方，你会看见<code>magnet:?xt=urn:btih:</code> <br>且文中会有神秘代码，我猜你应该知道怎么用。</p><h3 id="如何使用灵梦御所">如何使用灵梦御所</h3><p>在hosts文件里加入记录<code>104.28.28.43 blog.reimu.net</code> <br>文件位置：C:\Windows\System32\drivers\etc\hosts <br>按win+r输入cmd打开，输入<code>ipconfig /flushdns</code>后即可无需魔法访问网站 <br>打开网站后会提示输入密码，密码为⑨，下载的压缩包密码基本上也是⑨，除非有特别说明 <br><img src="/img/gal/reimu.png" alt="reimu"><br>找到相应Gal后，向下翻到发布者位置使用键盘按键↑↑↓↓←→←→BA即可得到隐藏内容 <br><img src="/img/gal/hide1.png" alt="hide1"><br><img src="/img/gal/hide2.png" alt="hide2"><br>部分内容为标准码而非网盘链接</p><h3 id="标准码使用">标准码使用</h3><p>使用Chrome或者Firefox浏览器，安装 <a href="https://chrome.google.com/webstore/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo">Tampermonkey</a> (油猴)插件 <br>并在插件管理页面安装 <a href="https://greasyfork.org/zh-CN/scripts/427628-%E7%99%BE%E5%BA%A6%E7%BD%91%E7%9B%98%E7%A7%92%E4%BC%A0%E9%93%BE%E6%8E%A5%E6%8F%90%E5%8F%96-%E6%9C%80%E6%96%B0%E5%8F%AF%E7%BB%B4%E6%8A%A4%E7%89%88%E6%9C%AC">秒传链接提取</a> 脚本<br>打开 <a href="https://pan.baidu.com/">百度网盘网页版</a> 看见上传按键旁多出&quot;秒传链接&quot; <br>复制标准码保存到网盘下载即可<br><img src="/img/gal/pan.png" alt="pan"></p>]]></content>
      
      
      <categories>
          
          <category> 游戏 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 教程 </tag>
            
            <tag> Galgame </tag>
            
            <tag> 游戏 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
